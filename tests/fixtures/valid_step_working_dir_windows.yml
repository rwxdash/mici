version: "1.0"
name: "step-workdir-test"
description: "Tests step-level working_directory with input resolution"

configuration:
  confirm: false

inputs:
  target-dir:
    type: string
    description: "Target directory to run in"
    required: true
    short: -d
    long: --target-dir
  other-dir:
    type: string
    description: "Another directory"
    required: true
    short: -o
    long: --other-dir

steps:
  - id: "first_step"
    name: "First step with its own working directory"
    run:
      shell: "powershell"
      working_directory: "@{inputs.other-dir}"
      command: "Write-Output first"

  - id: "print_cwd"
    name: "Print current working directory"
    run:
      shell: "powershell"
      working_directory: "@{inputs.target-dir}"
      command: "Get-Location | Select-Object -ExpandProperty Path"

  - id: "third_step"
    name: "Third step with its own working directory"
    run:
      shell: "powershell"
      working_directory: "@{inputs.other-dir}"
      command: "Write-Output third"
